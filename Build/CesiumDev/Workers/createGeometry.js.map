{"version":3,"file":"createGeometry.js","sources":["../../../packages/engine/Source/WorkersES6/createGeometry.js"],"sourcesContent":["/* global require */\r\nimport defined from \"../Core/defined.js\";\r\nimport PrimitivePipeline from \"../Scene/PrimitivePipeline.js\";\r\nimport createTaskProcessorWorker from \"./createTaskProcessorWorker.js\";\r\n\r\nconst moduleCache = {};\r\n\r\nfunction getModule(moduleName) {\r\n  let module = moduleCache[moduleName];\r\n  if (!defined(module)) {\r\n    if (typeof exports === \"object\") {\r\n      // Use CommonJS-style require.\r\n      moduleCache[module] = module = require(`Workers/${moduleName}`);\r\n    } else {\r\n      // Use AMD-style require.\r\n      // in web workers, require is synchronous\r\n      require([`Workers/${moduleName}`], function (f) {\r\n        module = f;\r\n        moduleCache[module] = f;\r\n      });\r\n    }\r\n  }\r\n  return module;\r\n}\r\n\r\nfunction createGeometry(parameters, transferableObjects) {\r\n  const subTasks = parameters.subTasks;\r\n  const length = subTasks.length;\r\n  const resultsOrPromises = new Array(length);\r\n\r\n  for (let i = 0; i < length; i++) {\r\n    const task = subTasks[i];\r\n    const geometry = task.geometry;\r\n    const moduleName = task.moduleName;\r\n\r\n    if (defined(moduleName)) {\r\n      const createFunction = getModule(moduleName);\r\n      resultsOrPromises[i] = createFunction(geometry, task.offset);\r\n    } else {\r\n      //Already created geometry\r\n      resultsOrPromises[i] = geometry;\r\n    }\r\n  }\r\n\r\n  return Promise.all(resultsOrPromises).then(function (results) {\r\n    return PrimitivePipeline.packCreateGeometryResults(\r\n      results,\r\n      transferableObjects\r\n    );\r\n  });\r\n}\r\nexport default createTaskProcessorWorker(createGeometry);\r\n"],"names":["defined","PrimitivePipeline"],"mappings":";;EAAA;AAIA;EACA,MAAM,WAAW,GAAG,EAAE,CAAC;AACvB;EACA,SAAS,SAAS,CAAC,UAAU,EAAE;EAC/B,EAAE,IAAI,MAAM,GAAG,WAAW,CAAC,UAAU,CAAC,CAAC;EACvC,EAAE,IAAI,CAACA,oBAAO,CAAC,MAAM,CAAC,EAAE;EACxB,IAAI,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;EACrC;EACA,MAAM,WAAW,CAAC,MAAM,CAAC,GAAG,MAAM,GAAG,OAAO,CAAC,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC;EACtE,KAAK,MAAM;EACX;EACA;EACA,MAAM,OAAO,CAAC,CAAC,CAAC,QAAQ,EAAE,UAAU,CAAC,CAAC,CAAC,EAAE,UAAU,CAAC,EAAE;EACtD,QAAQ,MAAM,GAAG,CAAC,CAAC;EACnB,QAAQ,WAAW,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;EAChC,OAAO,CAAC,CAAC;EACT,KAAK;EACL,GAAG;EACH,EAAE,OAAO,MAAM,CAAC;EAChB,CAAC;AACD;EACA,SAAS,cAAc,CAAC,UAAU,EAAE,mBAAmB,EAAE;EACzD,EAAE,MAAM,QAAQ,GAAG,UAAU,CAAC,QAAQ,CAAC;EACvC,EAAE,MAAM,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC;EACjC,EAAE,MAAM,iBAAiB,GAAG,IAAI,KAAK,CAAC,MAAM,CAAC,CAAC;AAC9C;EACA,EAAE,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,MAAM,EAAE,CAAC,EAAE,EAAE;EACnC,IAAI,MAAM,IAAI,GAAG,QAAQ,CAAC,CAAC,CAAC,CAAC;EAC7B,IAAI,MAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;EACnC,IAAI,MAAM,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;AACvC;EACA,IAAI,IAAIA,oBAAO,CAAC,UAAU,CAAC,EAAE;EAC7B,MAAM,MAAM,cAAc,GAAG,SAAS,CAAC,UAAU,CAAC,CAAC;EACnD,MAAM,iBAAiB,CAAC,CAAC,CAAC,GAAG,cAAc,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,CAAC,CAAC;EACnE,KAAK,MAAM;EACX;EACA,MAAM,iBAAiB,CAAC,CAAC,CAAC,GAAG,QAAQ,CAAC;EACtC,KAAK;EACL,GAAG;AACH;EACA,EAAE,OAAO,OAAO,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAAC,UAAU,OAAO,EAAE;EAChE,IAAI,OAAOC,mCAAiB,CAAC,yBAAyB;EACtD,MAAM,OAAO;EACb,MAAM,mBAAmB;EACzB,KAAK,CAAC;EACN,GAAG,CAAC,CAAC;EACL,CAAC;AACD,yBAAe,yBAAyB,CAAC,cAAc,CAAC;;;;;;;;"}